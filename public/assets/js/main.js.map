{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst formElement = document.querySelector('#form');\nconst inputElement = document.querySelector('#searchInput');\nconst searchListElement = document.querySelector('#searchList');\nconst favoriteListElement = document.querySelector('#favoriteList');\nconst listDivElement = document.querySelector('#listsDiv')\nconst header = document.querySelector('.header')\n\nasync function handlerSearch(event) {\n  searchListElement.innerHTML = ''; \n  const search = inputElement.value;\n  event.preventDefault();\n\n  header.style.height = \"140px\";\n\n  const response = await fetch(`http://api.tvmaze.com/search/shows?q=${search}`)\n  const series = await response.json();\n\n  const listItemsContainer = document.createElement('div');\n  listItemsContainer.classList.add('main__lists__searchList-container');\n  const searchListTitle = document.createElement('h2');\n  searchListTitle.classList.add('main__lists__searchList-searchListTitle');\n  searchListTitle.innerHTML = `We find ${series.length} results`;\n  searchListElement.appendChild(searchListTitle);\n\n  for (let serieItem of series) {\n    const serieObject = {};\n    const serieId = `${serieItem.show.id}`; // convertimos el id a string\n\n    const liElement = document.createElement('li');\n    liElement.classList.add('main__lists__searchList-container-liContainer');\n\n    //Comprobamos los items guardados en favoritos en localstore y les añadimos la clase favorite\n    if (isFavSerie(serieId)) {\n      liElement.classList.add('favorite');\n      console.log(serieId);\n    }\n    //const premiere = document.createElement('p');\n    //premiere.innerHTML = serieItem.show.premiered;\n    const span = document.createElement('span');\n    span.classList.add('main__lists__searchList-container-liContainer-span');\n    span.innerHTML = serieItem.show.name;\n    serieObject.name = serieItem.show.name;\n    const imageElement = document.createElement('img');\n    if (serieItem.show.image === null) {\n      imageElement.src = \"https://via.placeholder.com/210x295/868282/fff/?text=IMAGEN%20NOT%20FOUND\"\n      serieObject.image = imageElement.src;\n    } else {\n      imageElement.src = serieItem.show.image.medium;\n      serieObject.image = serieItem.show.image.medium;\n    }\n    liElement.appendChild(span);\n    liElement.id = serieId;\n    //liElement.appendChild(premiere);\n    liElement.appendChild(imageElement);\n    listItemsContainer.appendChild(liElement);\n    searchListElement.appendChild(listItemsContainer);\n    console.log(serieObject);\n  }\n  \n\nconst liElements = document.querySelectorAll('.main__lists__searchList-container-liContainer');\nfor (const itemLi of liElements) {\nitemLi.addEventListener('click', favoriteShow);\n\nformElement.addEventListener('click', ShowNumberResults);\n}\n\n  /* fetch(`http://api.tvmaze.com/search/shows?q=${search}`)\n    .then(function (response) {\n        return response.json();\n    })\n    .then(\n      function getData (series) {\n        const listItemsContainer = document.createElement('div');\n        listItemsContainer.classList.add('main__lists__searchList-container');\n        const searchListTitle = document.createElement('h2');\n        searchListTitle.classList.add('main__lists__searchList-searchListTitle');\n        searchListTitle.innerHTML = 'Resultados de búsqueda:';\n        searchListElement.appendChild(searchListTitle);\n        for (let serieItem of series) {\n          const serieObject = {};\n          const serieId = `${serieItem.show.id}`; // convertimos el id a string\n\n          const liElement = document.createElement('li');\n          liElement.classList.add('main__lists__searchList-container-liContainer');\n\n          //Comprobamos los items guardados en favoritos en localstore y les añadimos la clase favorite\n          if (isFavSerie(serieId)) {\n            liElement.classList.add('favorite');\n            console.log(serieId);\n          }\n          const premiere = document.createElement('p');\n          premiere.innerHTML = serieItem.show.premiered;\n          const span = document.createElement('span');\n          span.classList.add('main__lists__searchList-container-liContainer-span');\n          span.innerHTML = serieItem.show.name;\n          serieObject.name = serieItem.show.name;\n          const imageElement = document.createElement('img');\n          if (serieItem.show.image === null) {\n            imageElement.src = \"https://via.placeholder.com/210x295/868282/fff/?text=SERIE%20SIN%20IMAGEN\"\n            serieObject.image = imageElement.src;\n          } else {\n            imageElement.src = serieItem.show.image.medium;\n            serieObject.image = serieItem.show.image.medium;\n          }\n          liElement.appendChild(span);\n          liElement.id = serieId;\n          liElement.appendChild(premiere);\n          liElement.appendChild(imageElement);\n          listItemsContainer.appendChild(liElement);\n          searchListElement.appendChild(listItemsContainer);\n          console.log(serieObject);\n          \n\n        }\n    const numberResults = document.createElement('h3');\n    numberResults.innerHTML = `Hemos encontrado ${series.length}.`;\n    searchListElement.appendChild(numberResults);\n    const liElements = document.querySelectorAll('.main__lists__searchList-container-liContainer');\n    for (const itemLi of liElements) {\n      itemLi.addEventListener('click', favoriteShow);\n\n    numberResults.addEventListener('click', ShowNumberResults);\n    }\n  }); */\n  return false;\n}\n\nfunction ShowNumberResults(series) {\n  if (series.length < 5) {\n    console.log('El número de resultados es menor que 5.');\n  } else if (series.length > 5 && series.length < 8){\n    console.log('El número de resultados es mayor que 5 y menor que 8.');\n  } else if (series.length > 8 && series.length < 10){\n    console.log('El número de resultados es mayor que 8 y menor que 10.');\n  } else {\n    console.log('El número de resultados es mayor que 10.');\n  }\n}\n\nlet favSeriesArray = [];\n\nfunction addFavSerie(serie) {\n  favSeriesArray.push(serie);\n  const favseries = JSON.stringify(favSeriesArray);\n  localStorage.setItem('favorites', favseries);\n  //console.log(favSeriesArray);\n}\n\nfunction removeFavSerie(serieId) {\n//Comprobamos los items guardados en favoritos en localstore y les añadimos la clase favorite\n  for(let i = 0; i < favSeriesArray.length; i++) {\n    const serie = favSeriesArray[i];\n\n    if (serie.id === serieId) {\n      favSeriesArray.splice(i, 1);\n      const favseries = JSON.stringify(favSeriesArray);\n      localStorage.setItem('favorites', favseries);\n\n      console.log(favSeriesArray);\n      return;\n    }\n  }\n}\n\nfunction isFavSerie(serieId) {\n  for(let i = 0; i < favSeriesArray.length; i++) {\n    const serie = favSeriesArray[i];\n\n    if (serie.id === serieId) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction favoriteShow(event) {\n  event.preventDefault;\n  //cambio de color de los favoritos\n  const serieElement = event.currentTarget;\n  const serieId = serieElement.id;\n  serieElement.classList.toggle('favorite');\n\n  //añadir series a favoritos\n  if(serieElement.classList.contains('favorite')) {\n    const serieObject = {};\n    const imageElement = serieElement.querySelector('img');\n    const titleElement = serieElement.querySelector('.main__lists__searchList-container-liContainer-span');\n\n    serieObject.title = titleElement.innerHTML;\n    serieObject.image = imageElement.src;\n    serieObject.id = serieId;\n\n    addFavSerie(serieObject);\n  } else {\n    removeFavSerie(serieId);\n  }\n  getFavorites()\n}\n\nfunction printFavoriteList(favSeriesArray){\n  //creamos la lista para guardar los items y un título para esta\n  const favoriteSearched = document.createElement('ul');\n  favoriteSearched.classList.add('main__lists__favoriteList');\n  const favoriteListTitle = document.createElement('h2');\n  favoriteListTitle.classList.add('main__lists__favoriteList-listTitle');\n  favoriteListTitle.innerHTML = 'Favorites';\n  favoriteSearched.appendChild(favoriteListTitle);\n\n\n  //Por cada item del array de localStore, creamos un li\n  for(const serie of favSeriesArray){\n\n  //Creamos el li y le añadimos clase e id para seleccionarlo más tarde\n  const favoriteSearchedItem = document.createElement('li');\n  favoriteSearchedItem.id = serie.id;\n  favoriteSearchedItem.classList.add('main__lists__favoriteList-favoriteItem');\n\n  //Creamos un elemento contenedor del nombre y el close del favorito\n  const headerLiContainer = document.createElement('div');\n  headerLiContainer.classList.add('.main__lists__favoriteList-favoriteItem-header')\n  const closeFavoriteElement = document.createElement('div');\n\n  //Creamos un div para el icono de cerrar\n  closeFavoriteElement.classList.add('main__lists__favoriteList-favoriteItem-header-closeElement')\n  closeFavoriteElement.id = 'closeElement';\n  closeFavoriteElement.innerHTML = '<i class=\"fas fa-times-circle\"></i>'\n\n  //Creamos el span con el nombre de la serie\n  const favoriteSearchedTitle = document.createElement('span');\n  favoriteSearchedTitle.classList.add('main__lists__favoriteList-favoriteItem-header-span');\n  favoriteSearchedTitle.innerHTML = serie.title;\n\n  //Creamos la imagen\n  const favoriteSearchedImage = document.createElement('img');\n  favoriteSearchedImage.classList.add('main__lists__favoriteList-favoriteItem-header-image');\n  favoriteSearchedImage.src = serie.image;\n\n  //Introducimos los elementos en sus respectivos padres\n  favoriteSearchedItem.appendChild(closeFavoriteElement);\n  favoriteSearchedItem.appendChild(favoriteSearchedTitle);\n  favoriteSearchedItem.appendChild(headerLiContainer);\n  favoriteSearchedItem.appendChild(favoriteSearchedImage);\n  favoriteSearched.appendChild(favoriteSearchedItem);\n  listDivElement.appendChild(favoriteSearched);\n\n  //Función para borrar\n  closeFavoriteElement.addEventListener('click', removeFavoriteClass);\n  }\n}\n\nfunction removeFavoriteClass (event) {\n  event.preventDefault;\n  const serieElement = event.currentTarget.parentElement;\n\n    for(let i = 0; i < favSeriesArray.length; i++) {\n      const serie = favSeriesArray[i];\n      \n      //Comprobamos por el id si el elemento ya está en el array y si es así, lo quitamos del array y de lo guardado en localstore\n      if (serie.id === serieElement.id) {\n        favSeriesArray.splice(i, 1); \n        const li = document.getElementById(serie.id);\n        li.classList.remove('favorite');\n        const favseries = JSON.stringify(favSeriesArray);\n        localStorage.setItem('favorites', favseries);\n\n        removeFavSerie();\n      }\n    }\n    //Llamamos a getfavorites otra vez para que nos actualice los items pintados a partir del localstore\n     getFavorites()\n  }\n\n\nfunction getFavorites() {\n  const favSeries = JSON.parse(localStorage.getItem('favorites'));\n  if (favSeries.length > 0) {\n    favSeriesArray = favSeries;\n    header.style.height = \"140px\";\n  } else {\n    header.style.height = \"100%\";\n  }\n  //Para que la lista no se pinte más de una vez, la reemplazamos borrándola antes (comprobamos primero que exista la lista de favoritos)\n  if(listDivElement.childNodes.length===3) {\n  //console.log(listDivElement.childNodes);\n  listDivElement.removeChild(listDivElement.childNodes[2]);\n  printFavoriteList(favSeries);\n  //console.log(listDivElement.childNodes);\n}\n  else {\n    printFavoriteList(favSeries);\n    return;\n  }\n}\n\nwindow.addEventListener('load', getFavorites);\nformElement.addEventListener('submit', handlerSearch);\n"]}