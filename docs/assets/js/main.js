"use strict";const formElement=document.querySelector("#form"),inputElement=document.querySelector("#searchInput"),searchListElement=document.querySelector("#searchList"),favoriteListElement=document.querySelector("#favoriteList"),listDivElement=document.querySelector("#listsDiv"),header=document.querySelector(".header");async function handlerSearch(e){searchListElement.innerHTML="";const t=inputElement.value;e.preventDefault(),header.style.height="140px";const i=await fetch(`https://api.tvmaze.com/search/shows?q=${t}`),s=await i.json(),r=document.createElement("div");r.classList.add("main__lists__searchList-container");const a=document.createElement("h2");a.classList.add("main__lists__searchList-searchListTitle"),a.innerHTML=`We find ${s.length} results`,searchListElement.appendChild(a);for(let e of s){const t={},i=`${e.show.id}`,s=document.createElement("li");s.classList.add("main__lists__searchList-container-liContainer"),isFavSerie(i)&&(s.classList.add("favorite"),console.log(i));const a=document.createElement("span");a.classList.add("main__lists__searchList-container-liContainer-span"),a.innerHTML=e.show.name,t.name=e.show.name;const n=document.createElement("img");null===e.show.image?(n.src="https://via.placeholder.com/210x295/868282/fff/?text=IMAGEN%20NOT%20FOUND",t.image=n.src):(n.src=e.show.image.medium,t.image=e.show.image.medium),s.appendChild(a),s.id=i,s.appendChild(n),r.appendChild(s),searchListElement.appendChild(r),console.log(t)}const n=document.querySelectorAll(".main__lists__searchList-container-liContainer");for(const e of n)e.addEventListener("click",favoriteShow),formElement.addEventListener("click",ShowNumberResults);return!1}function ShowNumberResults(e){e.length<5?console.log("El número de resultados es menor que 5."):e.length>5&&e.length<8?console.log("El número de resultados es mayor que 5 y menor que 8."):e.length>8&&e.length<10?console.log("El número de resultados es mayor que 8 y menor que 10."):console.log("El número de resultados es mayor que 10.")}let favSeriesArray=[];function addFavSerie(e){favSeriesArray.push(e);const t=JSON.stringify(favSeriesArray);localStorage.setItem("favorites",t)}function removeFavSerie(e){for(let t=0;t<favSeriesArray.length;t++){if(favSeriesArray[t].id===e){favSeriesArray.splice(t,1);const e=JSON.stringify(favSeriesArray);return localStorage.setItem("favorites",e),void console.log(favSeriesArray)}}}function isFavSerie(e){for(let t=0;t<favSeriesArray.length;t++){if(favSeriesArray[t].id===e)return!0}return!1}function favoriteShow(e){e.preventDefault;const t=e.currentTarget,i=t.id;if(t.classList.toggle("favorite"),t.classList.contains("favorite")){const e={},s=t.querySelector("img"),r=t.querySelector(".main__lists__searchList-container-liContainer-span");e.title=r.innerHTML,e.image=s.src,e.id=i,addFavSerie(e)}else removeFavSerie(i);getFavorites()}function printFavoriteList(e){const t=document.createElement("ul");t.classList.add("main__lists__favoriteList");const i=document.createElement("h2");i.classList.add("main__lists__favoriteList-listTitle"),i.innerHTML="Favorites",t.appendChild(i);for(const i of e){const e=document.createElement("li");e.id=i.id,e.classList.add("main__lists__favoriteList-favoriteItem");const s=document.createElement("div");s.classList.add(".main__lists__favoriteList-favoriteItem-header");const r=document.createElement("div");r.classList.add("main__lists__favoriteList-favoriteItem-header-closeElement"),r.id="closeElement",r.innerHTML='<i class="fas fa-times-circle"></i>';const a=document.createElement("span");a.classList.add("main__lists__favoriteList-favoriteItem-header-span"),a.innerHTML=i.title;const n=document.createElement("img");n.classList.add("main__lists__favoriteList-favoriteItem-header-image"),n.src=i.image,e.appendChild(r),e.appendChild(a),e.appendChild(s),e.appendChild(n),t.appendChild(e),listDivElement.appendChild(t),r.addEventListener("click",removeFavoriteClass)}}function removeFavoriteClass(e){e.preventDefault;const t=e.currentTarget.parentElement;for(let e=0;e<favSeriesArray.length;e++){const i=favSeriesArray[e];if(i.id===t.id){favSeriesArray.splice(e,1),document.getElementById(i.id).classList.remove("favorite");const t=JSON.stringify(favSeriesArray);localStorage.setItem("favorites",t),removeFavSerie()}}getFavorites()}function getFavorites(){const e=JSON.parse(localStorage.getItem("favorites"));e.length>0?(favSeriesArray=e,header.style.height="140px"):header.style.height="100%",3===listDivElement.childNodes.length?(listDivElement.removeChild(listDivElement.childNodes[2]),printFavoriteList(e)):printFavoriteList(e)}window.addEventListener("load",getFavorites),formElement.addEventListener("submit",handlerSearch);