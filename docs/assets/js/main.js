"use strict";const formElement=document.querySelector("#form"),inputElement=document.querySelector("#searchInput"),searchListElement=document.querySelector("#searchList"),favoriteListElement=document.querySelector("#favoriteList"),listDivElement=document.querySelector("#listsDiv"),header=document.querySelector(".header");async function handlerSearch(a){searchListElement.innerHTML="";const e=inputElement.value;a.preventDefault(),header.style.height="140px";const s=await fetch(`https://api.tvmaze.com/search/shows?q=${e}`),t=await s.json(),r=document.createElement("div");r.classList.add("main__lists__searchList-container");const i=document.createElement("h2");i.classList.add("main__lists__searchList-searchListTitle"),i.innerHTML=`${t.length} titles`,searchListElement.appendChild(i);for(let a of t)if(null!==a.show.image){const e={},s=`${a.show.id}`,t=document.createElement("li");t.classList.add("main__lists__searchList-container-liContainer"),isFavSerie(s)&&(t.classList.add("favorite"),console.log(s));const i=document.createElement("div");i.classList.add("main__lists__searchList-container-liContainer-imageContainer");const n=document.createElement("p");n.classList.add("main__lists__searchList-container-liContainer-description-summary-info"),a.show.summary.length>400?n.innerHTML=`${a.show.summary.substr(0,400)}...`:n.innerHTML=`${a.show.summary}`;const l=document.createElement("div");l.classList.add("main__lists__searchList-container-liContainer-description-genre");const o=a.show.genres;for(let a=0;a<o.length;a++)l.innerHTML+=o[a]+" ";const c=document.createElement("div");c.classList.add("main__lists__searchList-container-liContainer-description-header-language"),c.innerHTML=`Language: ${a.show.language}`;const d=document.createElement("div");d.classList.add("main__lists__searchList-container-liContainer-description-header-average"),null!==a.show.rating.average?a.show.rating.average<=1?(d.innerHTML=`${a.show.rating.average} <i class="fas star fa-star-half-alt"></i></i><i class="star far fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=2&&a.show.rating.average<3?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=3&&a.show.rating.average<4?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="fas star fa-star-half-alt"></i><i class="star far fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=4&&a.show.rating.average<5?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star far fa-star"><i class="star far fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=5&&a.show.rating.average<6?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="fas star fa-star-half-alt"></i><i class="star far fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=6&&a.show.rating.average<7?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star far fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=7&&a.show.rating.average<8?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="fas star fa-star-half-alt"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=8&&a.show.rating.average<9?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star far fa-star"></i>`,t.style.order="0"):a.show.rating.average>=9&&a.show.rating.average<10?(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="fas star fa-star-half-alt"></i>`,t.style.order="0"):10===a.show.rating.average&&(d.innerHTML=`${a.show.rating.average} <i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i><i class="star fas fa-star"></i>`,t.style.order="0"):(d.innerHTML="Not average yet",t.style.order="1"),console.log(a.show.rating);const f=document.createElement("div");f.classList.add("main__lists__searchList-container-liContainer-description-header");const m=document.createElement("div");m.classList.add("main__lists__searchList-container-liContainer-description-header-span-addFavorite"),m.innerHTML='Add <i class="fas fa-heart"></i> favorite ';const h=document.createElement("span");h.classList.add("main__lists__searchList-container-liContainer-description-header-span"),h.innerHTML=`<div class="main__lists__searchList-container-liContainer-description-header-span-title">${a.show.name}<div>`,h.appendChild(m),e.name=a.show.name;const v=document.createElement("img");null===a.show.image?(v.src="https://via.placeholder.com/210x295/868282/fff/?text=IMAGEN%20NOT%20FOUND",e.image=v.src):(v.src=a.show.image.medium,e.image=a.show.image.medium),t.id=s;const g=document.createElement("div");g.classList.add("main__lists__searchList-container-liContainer-description-summary");const u=document.createElement("div");u.classList.add("main__lists__searchList-container-liContainer-description"),f.appendChild(h),f.appendChild(d),u.appendChild(f),u.appendChild(g),f.appendChild(c),g.appendChild(n),g.appendChild(l),i.appendChild(v),t.appendChild(i),t.appendChild(u),r.appendChild(t),searchListElement.appendChild(r),console.log(e)}const n=document.querySelectorAll(".main__lists__searchList-container-liContainer");for(const a of n)a.addEventListener("click",favoriteShow),formElement.addEventListener("click",ShowNumberResults);return!1}function ShowNumberResults(a){a.length<5?console.log("El número de resultados es menor que 5."):a.length>5&&a.length<8?console.log("El número de resultados es mayor que 5 y menor que 8."):a.length>8&&a.length<10?console.log("El número de resultados es mayor que 8 y menor que 10."):console.log("El número de resultados es mayor que 10.")}let favSeriesArray=[];function addFavSerie(a){favSeriesArray.push(a);const e=JSON.stringify(favSeriesArray);localStorage.setItem("favorites",e)}function removeFavSerie(a){for(let e=0;e<favSeriesArray.length;e++){if(favSeriesArray[e].id===a){favSeriesArray.splice(e,1);const a=JSON.stringify(favSeriesArray);return localStorage.setItem("favorites",a),void console.log(favSeriesArray)}}}function isFavSerie(a){for(let e=0;e<favSeriesArray.length;e++){if(favSeriesArray[e].id===a)return!0}return!1}function favoriteShow(a){a.preventDefault;const e=a.currentTarget,s=e.id;if(e.classList.toggle("favorite"),e.classList.contains("favorite")){const a={},t=e.querySelector("img");e.querySelector(".main__lists__searchList-container-liContainer-span");a.image=t.src,a.id=s,addFavSerie(a)}else removeFavSerie(s);getFavorites()}function printFavoriteList(a){const e=document.createElement("ul");e.classList.add("main__lists__favoriteList");const s=document.createElement("h2");s.classList.add("main__lists__favoriteList-listTitle"),s.innerHTML="Favorites",e.appendChild(s);for(const s of a){const a=document.createElement("li");a.id=s.id,a.classList.add("main__lists__favoriteList-favoriteItem");const t=document.createElement("div");t.classList.add(".main__lists__favoriteList-favoriteItem-header");const r=document.createElement("div");r.classList.add("main__lists__favoriteList-favoriteItem-header-closeElement"),r.id="closeElement",r.innerHTML='<i class="fas fa-times-circle"></i>';const i=document.createElement("img");i.classList.add("main__lists__favoriteList-favoriteItem-header-image"),i.src=s.image,a.appendChild(r),a.appendChild(t),a.appendChild(i),e.appendChild(a),listDivElement.appendChild(e),r.addEventListener("click",removeFavoriteClass)}}function removeFavoriteClass(a){a.preventDefault;const e=a.currentTarget.parentElement;for(let a=0;a<favSeriesArray.length;a++){const s=favSeriesArray[a];if(s.id===e.id){favSeriesArray.splice(a,1),document.getElementById(s.id).classList.remove("favorite");const e=JSON.stringify(favSeriesArray);localStorage.setItem("favorites",e),removeFavSerie()}}getFavorites()}const favSeries=JSON.parse(localStorage.getItem("favorites"));function getFavorites(){const a=JSON.parse(localStorage.getItem("favorites"));a.length>0&&(favSeriesArray=a,header.style.height="140px"),3===listDivElement.childNodes.length?(listDivElement.removeChild(listDivElement.childNodes[2]),printFavoriteList(a)):printFavoriteList(a)}window.addEventListener("load",getFavorites),formElement.addEventListener("submit",handlerSearch);